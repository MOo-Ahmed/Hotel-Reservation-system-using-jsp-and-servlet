SELECT DISTINCT (hotel.id) AS HotelID, COUNT(hotel.id) AS RoomsCount , hotel.name AS HotelName FROM hotel INNER JOIN
	(SELECT * FROM room WHERE room.id IN 
    	(SELECT roomreservation.roomID AS roomID FROM roomreservation INNER JOIN reservation 
         ON roomreservation.reservationID = reservation.id AND reservation.endDate <= '2021-01-04')) AS Q2
ON hotel.id = Q2.hotelID AND hotel.cityID IN 
	(SELECT city.id FROM city WHERE LOWER(city.name) LIKE LOWER('%CAiro%')) 
    GROUP BY (hotel.id) HAVING RoomsCount >= 2